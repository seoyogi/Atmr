<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Atsumori Style - AFrame Version</title>

<script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/cannon-es@0.20.0/dist/cannon-es.js"></script>

<style>
#viewButton {
  position: absolute;
  right: 20px;
  bottom: 20px;
  padding: 10px;
  font-size: 16px;
  z-index: 10;
}
</style>
</head>

<body>

<button id="viewButton">視点切替</button>

<a-scene physics="gravity: -9.8">

  <!-- 空 -->
  <a-sky color="#87CEEB"></a-sky>

  <!-- 島 -->
  <a-cylinder
    position="0 0 0"
    radius="60"
    height="0.5"
    color="#3cb043"
    static-body>
  </a-cylinder>

  <!-- 砂浜 -->
  <a-cylinder
    position="0 -0.1 0"
    radius="75"
    height="0.4"
    color="#e8d8a8"
    static-body>
  </a-cylinder>

  <!-- 海 -->
  <a-box
    position="0 -1 0"
    width="400"
    depth="400"
    height="1"
    color="#1e4f9c"
    static-body>
  </a-box>

  <!-- プレイヤー -->
  <a-entity id="player"
    position="0 2 0"
    dynamic-body="mass: 5">

    <a-entity
      id="character"
      gltf-model="girl character 3d model.glb"
      scale="1 1 1">
    </a-entity>

    <a-entity id="camera"
      camera
      position="0 3 6"
      look-controls="enabled:false">
    </a-entity>

  </a-entity>

</a-scene>

<script>

let mode = 0;

document.getElementById("viewButton").onclick = () => {
  mode = (mode + 1) % 2;

  const cam = document.getElementById("camera");

  if (mode === 0) {
    cam.setAttribute("position", "0 3 6");
  } else {
    cam.setAttribute("position", "0 3 -6");
  }
};

// キーボード移動
document.addEventListener("keydown", (e) => {
  const player = document.getElementById("player");

  let pos = player.getAttribute("position");

  const speed = 0.5;

  if (e.key === "w" || e.key === "ArrowUp") pos.z -= speed;
  if (e.key === "s" || e.key === "ArrowDown") pos.z += speed;
  if (e.key === "a" || e.key === "ArrowLeft") pos.x -= speed;
  if (e.key === "d" || e.key === "ArrowRight") pos.x += speed;

  // 海に出ないよう制限
  const dist = Math.sqrt(pos.x*pos.x + pos.z*pos.z);
  if (dist < 58) {
    player.setAttribute("position", pos);
  }
});

</script>

</body>
</html>
